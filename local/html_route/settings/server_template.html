<h2 class="color-white">Settings</h2>
<div class="settings-title">
  <a ui-sref="frame.server-settings" ui-sref-active="settings-active-btn">
    <h4>Server Settings</h4>
  </a>
</div>

<div class="settings-toggle-btns-wrap">
  <p ng-click="settingsToggleBtn = false" ng-class="{'color-white' : !settingsToggleBtn}">General Settings</p>
  <div class="active-line-indicator settings-toggle-btns-indicator" ng-class="{'slide-line-indicator' : settingsToggleBtn}"></div>
</div>

<!-- general server settings !-->
<div class="settings-content-wrap" ng-hide="settingsToggleBtn">

  <div class="settings-box-wrap">
    <div class="settings-box">
      <h4>Serever status</h4>

      <div class="server-status-btn online" ng-if="server.upToDate">
        <small>Your server is currently</small>
        <p class="color-green">Up to date.</p>
      </div>

      <div class="server-status-btn offline" ng-if="!server.upToDate" ng-click="server.updateApp()">
        <small>Your server is currently</small>
        <p class="color-red">Not up to date.</p>
        <p>Update now</p>
      </div>

      <h5 class="color-transparent">Version:
        <span class="color-white">{{server.serverInfoData.version}}</span>
      </h5>
      <button type="button" class="settings-btn reboot" ng-click="server.updateApp()">Reboot Server</button>
    </div>

    <div class="settings-box">
      <h4>Server info</h4>

      <p class="color-green server-status-indicator" ng-if="!God.serverOffline">Online</p>
      <p class="color-red server-status-indicator" ng-if="God.serverOffline">Offline</p>

      <p class="color-transparent">Ping:
        <span class="color-white">{{server.serverInfoData.ping}}</span>
      </p>
      <p class="color-transparent">IP:
        <span class="color-white">{{server.serverInfoData.ip}}</span>
      </p>
      <p class="color-transparent">External IP:
        <span class="color-white">{{server.serverInfoData.external_ip}}</span>
      </p>
      <p class="color-transparent">OS:
        <span class="color-white">{{server.serverInfoData.node_platform}}</span>
      </p>
      <p class="color-transparent">Node version:
        <span class="color-white">{{server.serverInfoData.node_version}}</span>
      </p>
      <p class="color-transparent">Node arch:
        <span class="color-white">{{server.serverInfoData.node_arch}}</span>
      </p>

    </div>

    <div class="settings-box">
      <h4>Bridges</h4>
      <p class="server-status-indicator">{{server.bridges.length}}</p>
      <p class="color-transparent">Bridges currently on this server</p>

      <p>
        <span class="color-white" ng-repeat="bridge in server.bridges">{{bridge.name}}
          <span ng-hide="$index == server.bridges.length-1">,</span>
        </span>
      </p>
    </div>
  </div>

  <div class="settings-box-wrap">
    <div class="settings-box grow-box no-padding">
      <div class="settings-box-nav">
        <h4>Server Location</h4>
        <button class="settings-btn location" ng-click="server.useIpAddress()">
          Use your IP location
        </button>
      </div>
      <google-maps></google-maps>
    </div>

    <div class="settings-box no-padding">
      <h4>Server Activities</h4>
      <form type="form" id="change-server-name-form" autocomplete="off" ng-submit="server.changeServerName(server.serverInfoData.name)">
        <input type="text" id="settings-server-name" placeholder="Server name" class="form-input" ng-model="server.serverInfoData.name" required pattern=".{3,15}">
        <button type="submit" class="settings-btn green rename">Rename</button>
      </form>
      <div class="settings-box-nav settings-box-btn-wrap">
        <button type="button" class="settings-btn" data-toggle="collapse" data-target="#backup">Backup</button>
        <span>
          <input type="file" id="restore-server" accept="application/json" onchange="angular.element(this).scope().restore(this)">
          <label for="restore-server" class="settings-btn green">
            Restore
          </label>
        </span>
      </div>
    </div>
  </div>

  <div id="backup" class="collapse settings-backup">
    <h4 class="color-white">Download your backup form <a id="download-backup" download="nhome-config.json">HERE</a></h4>
  </div>

  <div class="settings-box-wrap">
    <button data-toggle="collapse" data-target="#server-log" class="settings-btn">
      <h4>Server Log</h4>
    </button>

    <div class="collapse settings-box" id="server-log">
      <div class="server-log-li">
        <h5 class="color-transparent">Server Action</h5>
        <h5 class="color-transparent">Time and Date</h5>
      </div>

      <ul class="server-log-list">
        <li class="server-log-li" ng-repeat="log in server.serverLog">
          <!--<span class="color-white">{{log.name}}</span>!-->
          <p class="color-white">{{log.msg}} </p>
          <p class="color-transparent">{{log.time * 1000 | date: 'd/MMM/yyyy HH:mm:ss'}}</p>
        </li>
      </ul>
    </div>
  </div>

  <div class="settings-box-wrap">
    <button data-toggle="collapse" data-target="#action-log" class="settings-btn">
      <h4>Action Log</h4>
    </button>
    <div class="collapse settings-box" id="action-log">
      <div class="server-log-li">
        <h5 class="color-transparent">Username</h5>
        <h5 class="color-transparent">Action</h5>
      </div>

      <ul class="server-log-list">
        <li class="server-log-li" ng-repeat="log in server.actionLog">
          <p class="color-white">{{log.user}} turned
            <b ng-if="server.testRegex(log.action, 'off')" class="color-orange">OFF</b>
            <b ng-if="server.testRegex(log.action, 'on')" class="color-blue">ON</b>
          </p>
          <p class="color-white">{{log.time | date: 'd/MMM/yyyy HH:mm:ss'}}</p>
        </li>
        <li ng-click="server.loadMoreLog()" class="button server-log-load-more">
          <p>Load more</p>
          <img src="img/button/plus-lblue.png">
        </li>
      </ul>
    </div>
  </div>
</div>

<!--
  <div class="row settings-row">
    <div class="col-xs-12 col-sm-12 col-md-10 settings-tab-hlp">
      <h4>Server Status</h4>
      <h4>Up to date:
        <span ng-class="{'color-green':server.upToDate,'color-orange': !server.upToDate}">
          <span ng-if="server.upToDate">Yes</span>
          <span ng-if="!server.upToDate">No</span>
          <span ng-if="server.upToDate === 'undefined'">Check failed</span>
        </span>
      </h4>
      <h4>Version:
        <span class="color-transparent">{{server.serverInfoData.version}}</span>
      </h4>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-2 settings-tab-hlp">
      <button ng-if="!server.upToDate" type="button" class="button blue-btn" ng-click="server.updateApp()">
        Update
      </button>
      <button ng-if="server.upToDate" type="button" class="button orange-btn" ng-click="server.updateApp()">
        Reboot
      </button>
    </div>
  </div>

  <div class="row settings-row">
    <h4>Server Info</h4>
    <p>Ping:
      <span class="color-transparent">{{server.serverInfoData.ping}}</span>
    </p>
    <p>IP:
      <span class="color-transparent">{{server.serverInfoData.ip}}</span>
    </p>
    <p>External IP:
      <span class="color-transparent">{{server.serverInfoData.external_ip}}</span>
    </p>
    <p>OS:
      <span class="color-transparent">{{server.serverInfoData.node_platform}}</span>
    </p>
    <p>Node version:
      <span class="color-transparent">{{server.serverInfoData.node_version}}</span>
    </p>
    <p>Node arch:
      <span class="color-transparent">{{server.serverInfoData.node_arch}}</span>
    </p>
  </div>

  <div class="row settings-row">
    <div class="col-xs-12 col-sm-8 col-lg-9 settings-tab-hlp">
      <h4>Bridges:</h4>
      <p>
        <span class="color-blue" ng-repeat="bridge in server.bridges">{{bridge.name}}
          <span ng-hide="$index == server.bridges.length-1">,</span>
        </span>
      </p>
    </div>
    <div class="col-xs-12 col-sm-4 col-lg-3 settings-tab-hlp">
      <form type="form" id="change-server-name-form" autocomplete="off" ng-submit="server.changeServerName(server.serverInfoData.name)">
        <input type="text" id="settings-server-name" placeholder="Server name" class="form-input" ng-model="server.serverInfoData.name">
      </form>
      <button type="submit" form="change-server-name-form" class="button blue-btn">Rename</button>
    </div>
  </div>

  <div class="row settings-row">
    <div class="col-xs-12 col-sm-12 col-md-6 settings-tab-hlp">
      <h4>Server Backup</h4>
      <input type="file" id="restore-server" accept="application/json" onchange="angular.element(this).scope().restore(this)">
      <label for="restore-server" class="button orange-btn">
        Restore
      </label>
      <button type="button" class="button blue-btn" data-toggle="collapse" data-target="#backup">
        Backup
      </button>
    </div>

    <div class="col-xs-12 col-sm-12 col-md-6 settings-tab-hlp justify-end">
      <button type="button" class="button orange-btn" ng-click="server.leaveServer()">
        Leave Server
      </button>
      <a ui-sref="frame.addserver" class="button blue-btn">
        Add New Servers
      </a>
    </div>
  </div>

  <div id="backup" class="collapse settings-backup">
    <h4 class="color-white">Download your backup form <a id="download-backup" download="nhome-config.json">HERE</a>
  </div>
  <div>
    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4 settings-box">
      <h3>Server Location</h3>
      <small class="color-transparent">Set your location according to the location of your server</small>
      <google-maps></google-maps>

      <div class="custom-input-wrap">
        <h3>Use IP address</h3>
        <input type="checkbox" id="google-maps-IP" ng-click="server.useIpAddress()">
        <label for="google-maps-IP" class="checkbox-label"></label>
      </div>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-7 settings-box">
      <h3>Server Log</h3>
      <div id="server-log">
        <p class="server-log-pre" ng-repeat="log in server.serverLog">
          <span class="color-blue">{{log.name}}</span>
          <span class="color-white">{{log.msg}} </span>
          <span class="color-transparent">{{log.time * 1000 | date: 'd/MMM/yyyy HH:mm:ss'}}</span>
        </p>
      </div>
    </div>
  </div>

  <button ng-show="server.activeUser.level === 'OWNER'" type="button" class="button red-btn" title="double click to confirm" ng-click="server.deleteServer()">
    Delete Server
  </button>
</div>
!-->
<!-- user settings !-->
<div class="settings-content-wrap" ng-show="settingsToggleBtn">
  <div class="settings-box-wrap">
    <div class="settings-box" ng-show="server.activeUser.level === 'OWNER'">
      <h3>Invite User</h3>
      <small class="color-transparent">Invite users to your server</small>

      <form type="form" autocomplete="off" ng-submit="server.inviteUser()">
        <div class="form-input-wrap">
          <label for="invite-email" class="form-label">Email</label>
          <input type="email" class="form-input" id="invite-email" name="Email" required>

          <label for="invite-msg" class="form-label">Short Message</label>
          <input type="text" class="form-input" id="invite-msg" name="Invite Message" required>

          <label for="invite-status" class="form-label">Choose Status</label>
          <select class="form-select" id="invite-status">
            <option value="ADMIN">Admin</option>
            <option value="OWNER">Owner</option>
            <!-- <option value="USER">User</option> !-->
          </select>
        </div>
        <br>
        <div class="display-flex">
          <button type="submit" class="settings-btn" ng-class="{'green': server.inviteSuccess}">
            Invite
          </button>
          <button type="reset" class="settings-btn green">
            Clear
          </button>
        </div>
      </form>
    </div>

    <div class="settings-box settings-table-wrap">
      <h3>User list</h3>

      <table class="settings-table">
        <tr class="color-transparent">
          <th>
            Email
          </th>
          <th>
            Name
          </th>
          <th>
            Staus
          </th>
        </tr>
        <tr ng-repeat="user in server.userList">
          <td>
            {{user.email}}
          </td>
          <td>
            {{user.username}}
          </td>
          <td ng-hide="server.activeUser.level === 'OWNER'">
            {{user.level}}
          </td>
          <td ng-show="server.activeUser.level === 'OWNER'">
            <select class="form-select settings-user-list-item" ng-model="user.level" ng-change="server.changeUserLevel(user.email, user.level)">
              <option value="OWNER">Owner</option>
              <option value="ADMIN">Admin</option>
              <!--<option value="USER">User</option>!-->
              <option value="DELETE" class="settings-delet-user">Delete</option>
            </select>
          </td>
        </tr>
      </table>
      <!--<div class="server-log-li">
        <h5 class="color-transparent">Email</h5>
        <h5 class="color-transparent">Name</h5>
        <h5 class="color-transparent">Status</h5>
      </div>

      <ul class="server-log-list">
        <li class="server-log-li" ng-repeat="user in server.userList">
          <p class="settings-user-list-item">{{user.email}}</p>
          <p class="settings-user-list-item">{{user.username}}</p>
          <p class="settings-user-list-item" ng-hide="server.activeUser.level === 'OWNER'">{{user.level}}</p>
          <select class="form-select settings-user-list-item" ng-model="user.level" ng-change="server.changeUserLevel(user.email, user.level)" ng-show="server.activeUser.level === 'OWNER'">
            <option value="OWNER">Owner</option>
            <option value="ADMIN">Admin</option>
            <option value="USER">User</option>
            <option value="DELETE" class="settings-delet-user">Delete</option>
          </select>
        </li>
      </ul>!-->
    </div>
  </div>
</div>

<!-- leave srever moadl !-->
<div class="custom-modal-window leave-server-modal">
  <div class="leave-server-content-wrap">
    <h2 class="color-white">You're about to leave server.</h2>
    <h3 class="color-white">Choose where you wan't to connect</h3>
    <button type="button" ng-repeat="server in server.leveServers" class="button leve-server-btn" ng-click="server.switchServer(server)">{{server.name}}</button>
  </div>
</div>
