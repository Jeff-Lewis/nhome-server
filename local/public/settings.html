<!DOCTYPE html>
<html>
  <head>
    <title>NHome</title>
    <script defer src="/socket.io/socket.io.js"></script>
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>

        $(function() {

            var conn = io.connect('/client');

            conn.emit('getServerStatus', function (status) {
                $('#name').text(status.name);
                $('#local_ip').text(status.ip);
                $('#external_ip').text(status.external_ip.replace(/^::ffff:/, ''));
                $('#app_version').text(status.version);
                $('#node_version').text(status.node_version);
            });

            conn.emit('getDevices', function (devices) {
                if (devices) devices.forEach(function (device) {
                    $('#devices').append($('<li>').text(device.name));
                });
            });

            conn.once('connect', function() {

                var start = Date.now();

                conn.emit('ping', function () {
                    $('#ping').text(Date.now() - start + 'ms');
                });
            });
        });

    </script>
  </head>
  <body>

    <h1>Settings</h1>

    <p>Name: <span id="name">Unknown</span></p>

    <p>Application version: <span id="app_version">-</span></p>

    <p>Node version: <span id="node_version">-</span></p>

    <p>Ping: <span id="ping">-</span></p>

    <p>Local IP: <span id="local_ip">-</span></p>

    <p>External IP: <span id="external_ip">-</span></p>

    <p>Devices:</p>
    <ul id="devices">
    </ul>
  </body>
</html>
